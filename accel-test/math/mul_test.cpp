#include "mathlib/mul.h"
#include <memory.h>

namespace accel::test {
    
    bool Karatsuba_Test() {
        static const coeff_t p[] = {
            0x78976a0be59ebbc2, 0xe0538dc7ac7a1425, 0x042ca1b88b6ca8ca, 0xb88d3f293c62bdcb,
            0xd594ba23db365e05, 0x6aa9be21e369659d, 0x8018315efedf9e47, 0xf7e705af26558e41,
            0xca6729468a712e13, 0x18b0771c5a9a84ef, 0x3c89aaf4258b4bcc, 0xa78f4f3be77381aa,
            0xed6fe9cbbf166866, 0xf955c58942350224, 0xa59d43e08c4bda60, 0xceadb86d0f66c2d0,
            0xf58d832e60bd9e61, 0xb0dcf7ea98a0e3e8, 0x5cfe73d7b5391053, 0x6ca855a7cec2e639,
            0xd3eb9606902990f2, 0xf0d22b9f1d99a731, 0x5744456a9ef8487c, 0x60c9e08b452c9ec4,
            0x826c1bb611100ca9, 0xb55d2837437e298d, 0x4cc56ca92aadb3fb, 0xba621ad23d640d8c,
            0xce52ea50d78578fb, 0xee7d4bc6ebab7631, 0x7fa82710e0d62ca8, 0x3c759c3ef9d99fd4,
            0x39b45b7e755f0f1f, 0x81e8ea5b403bfb5a, 0x0f22c82967fcedc3, 0x3b935a4f416f7f5a,
            0x66e37090ca28b0f9, 0xbd98c3fc1905337e, 0xb3440e8765b5ae38, 0xb0f65dc815d70fd7,
            0xece4ae841d178285, 0xfc12296c1c901771, 0xd241a57ced7515f6, 0x1e14cb4321338a94,
            0x16a77dd13e4c9954, 0x0adee42903791ed2, 0x61e97ba0ab051145, 0x3de8b463e977d083,
            0x56a369ebcbd4460a, 0x8ab49d9a1554bfa2, 0xd2670348edbb595a, 0x09417ca822c4e676,
            0xe19a94f035a18149, 0x4cd257056319ecd4, 0x70f31066482d9587, 0x0a129b714111a042,
            0xdd0b64026fefa1e7, 0xc53346baf1e9ef18, 0x320ebddd970cc186, 0xed760f5bd8ab79d8,
            0xa3df7011be2d36ae, 0xf5bcb4275db09c7e, 0x56d772fdbe8873ba, 0x4ca79e6a19e71078,
            0x895bb09b9ea0ec6a, 0xeaf55ec48c75495d, 0x7f508d993e4f4ae5, 0x21f6eff00dda4d0b,
            0x4eb5c28b1abe4547, 0x0a3769a12754e7b8, 0x613fb3365cc5be8f, 0xd07c4aecaf4476fc,
            0x5a228c3ed4af0688, 0xe0809c90ef5bc470, 0x38f0837838f4cf89, 0x3b33e430aa1d9530,
            0x9705c5d56c417e37, 0x7bcc03d224f50b10, 0x2b1164380d3b221c, 0x4edbfaafbbb458ca,
            0x103f2f2f14d2b4d6, 0xd5d57b361d594c9a, 0x3329755d1173ca4b, 0x99a61cc8804537bf,
            0xccc0e6be8cce0e25, 0x8faf7a8be09d82d2, 0xdfe88a0712887026, 0x224430831566b0de,
            0x8cccbb4c1021e9f6, 0x152f4484bf1422b9, 0xfcd1afcaaadf24ff, 0xbb540fe877d822a0,
            0x0e224881da1e72d5, 0x661531274e6f1a4f, 0xa2c3eed7c14b1ca0, 0x9c880ba5bdd5917f,
            0xd2dc457ebe222892, 0xfab2864ff1ec107d, 0xc080c93c118a8712, 0xa95d7faea1be5444,
            0x3c22c159dbdd5bb5, 0x9d6f4394a189ef5d, 0x31f97fc37685c1a1, 0xfd78274e66392e6a,
            0x6245647f169d8b37, 0xf46e39f4db1341b8, 0x84f63ba18daa33dc, 0x41e863919811b8aa,
            0x98f4d9285122dba7, 0xd5f89fc85faeb486, 0x73392d5dad812054, 0x58a9831c5bafdcd9,
            0xa230b54b871bd402, 0x2efd831c5d54768c, 0x76b91a7b21649666, 0x352bbadb7679806f,
            0x1db4f319db24bd46, 0xfc8bb2c3e2475297, 0x8aff9109f3e4eadf, 0x68c2efc313bdc6b7,
            0x194c4f4dcc674546, 0x23e3f0f6b6e4e01f, 0x5ef42e5cec4e56be, 0x5b0ac2356f226cf5,
            0xd246a0b46ac59dfc, 0x5f9c0ea2fce1d6b4, 0xf1cc970208fd8c11, 0xfe4da0131287a5e9
        };

        static const coeff_t q[] = {
            0xc1f9f4f564c583aa, 0x1dc269b9825a2ddc, 0x971a14d70f4e7041, 0x50b62243a2299b40,
            0xea58cd494919809c, 0xb101423d9fb1ab65, 0xb1fb50e90b36d3e9, 0x4f9d875c0ef00630,
            0x4821656121b7b2c3, 0x6bf1168ebfd8a100, 0x28424d7620b26b86, 0x3399fdcd51f19ab2,
            0x98dd9b3f0ad8f3db, 0x51f87eb5a9367590, 0xa0005694f2c8c72f, 0xf9e8ea51a54a34d6,
            0x5f941ae4e5ecbae5, 0x5e28e1c044ecea15, 0x5704658eabefc785, 0x0f03221069ca8a0b,
            0x8ea88f1a3b85eba7, 0xaf763eadbece9d1f, 0xab759c9c262a1d96, 0x4dd71c939ec822f1,
            0x341b85bcaa5d0546, 0x5cda8b90606974d4, 0xb3e52dce73534521, 0x6041ac9385383e7b,
            0x1acd039d4c60e1e6, 0xf00d656178d80f63, 0x2e1041e972797c65, 0xec1f05fd036ad20f,
            0xc472b9bf5b2e5039, 0xbefa870733705915, 0x75a78f63a5e0b56a, 0xce8cfdf075ac2f4c,
            0x58ee94b7725ec374, 0xe3a3b71c55188b6d, 0xe793f74972540ffe, 0x6f52894f45f03a6c,
            0x592f1eddd62ca220, 0xc81f74f1e563add1, 0xd6a53054b5340419, 0x96a3cd6f4b1d92fc,
            0x6ebf7a4e2481dbf5, 0x550ade0fdc2460ff, 0x42d3edbe75b09c98, 0xe914ff9f0854255d,
            0x0eac9f3208d4bcda, 0xf9755492cdfa8e7f, 0x8ce171c8754d406f, 0x1457c0df3e2ae4fb,
            0xb97fb408d8de9ed1, 0x4bac141fb931075e, 0x277ddf70a0932aee, 0x373e39645e1a594d,
            0xb3c210183cd92183, 0x7b2d8e4ad5b7b9e5, 0x39c463880d1d6cba, 0x8d6cd5f6172899e5,
            0x9502ff4499851b5b, 0x5961b9bbe9950135, 0x18178c59b888de27, 0xd109e3cce8dc5613,
            0x1ac216bc8565250e, 0xeefc5347deda41ec, 0xaf851e87c34b6ede, 0x36f0e7be4464d8f5,
            0x8db85c2031460964, 0x367ae2e478e4930d, 0xbdd836c02b857954, 0x5f8fc953fd9e7677,
            0xf9e1c02ab839996e, 0x7d077b926619c04c, 0x4faa1791bdc0cae1, 0x644ca4768a31f80b,
            0xf6fe6e7843ca67c0, 0xcee0d78b1c418b49, 0xbdc53724ccbc1b85, 0xb425f8dbf9f0e959,
            0xe569fd998b7f64c6, 0x57055985643a0b22, 0xeb05f154a181863a, 0xd9ad243befb7e8a2,
            0xea6ddccba5e333fd, 0xd58d33bf55b21cc9, 0xcd9ceab5a56f2e75, 0xbfbca9068e1f3a60,
            0x79c4c071441603b5, 0x73531f9572ff183f, 0x9770d27a2b61ff0b, 0xa81079007db79514,
            0xde286dea7d1f6030, 0xaac46b94179452c5, 0xe26d09f2a61ce63d, 0x5ebc56a82f77ea76,
            0x72113691dc0c5d1d, 0x478d4b28189e1f6a, 0xeb77e046352a97e8, 0xa36ef8cff85f0540,
            0x8ad8578bcd157289, 0x4fb2dfb78ea29dfa, 0x4151ad2d7eb83ae1, 0x8a968b3cb9324185,
            0xb56e2019c32fbd9f, 0xc523b483b30314b1, 0x18c70db436ea1486, 0x14856c7a6589eae2,
            0x4b4943f79c421d81, 0x618007166e615074, 0xd699959eff42ad7a, 0x269b8d197f167339,
            0x8dab8e6c2b2d7f03, 0x6095a359bcd5f907, 0x91c756f9602eaa80, 0xfbcfac8327210117,
            0x80efde74f46ba294, 0x87a420c86022a5e9, 0x2411a2e8ccc74e8b, 0xeb4c6c6371a7e393,
            0x1bec950bcd0b3df4, 0xbcb96a79db879bb6, 0xb388c6df834a9247, 0xb7627d50fbf1cd8e,
            0xfd8beb0baf170d70, 0x411069ac6d435591, 0x56489e3a1150d0ae, 0xab1348007c3a6fde
        };

        static const coeff_t n[] = {
            0xbe3acf8ef9c6f4d4, 0xf7befe9fbe9acb70, 0xd2d7edb52afc34af, 0xe6b78164738421d1,
            0xaea4d831a8d371bd, 0x442a0a360f3f2d3c, 0xa1ed4c7d5bcc4175, 0x84633197a943dee8,
            0x63c314015c227308, 0x2094cee641b243b0, 0x84014b9d2b8c5c45, 0x68e4659e56672700,
            0x4757c81ec9448afa, 0xafecaccb5bb8b287, 0x9a755739b8b4ad7e, 0x68155aada62dc4af,
            0x27281eae02cf0daa, 0x673fe0fc065185d5, 0xfb959662fa3ce3f6, 0x4103e82f9c14fe62,
            0x122e26393fabfe0f, 0x35975b39f19debf0, 0x41693167e6aadb0f, 0xb5138719c23b4fe5,
            0x5ad2cb799c0e03e3, 0xc12389b7ceb51b44, 0xc7f52c3f6ff3362e, 0x11fbf7e9e66b473b,
            0x9a1800165be8dff4, 0xbf27a10747d1fcaf, 0x92027545a68ec9e4, 0x265aff9c771309e2,
            0x29c3d523bf20b929, 0x5f7881490639aea7, 0xd9bc898c9037037a, 0x85d95cd7496dec21,
            0xa5c057714a27a5dc, 0xabcc64e133052877, 0x85ab0b616b10c0f7, 0xc17952f5882239eb,
            0x9d2ce079ce929e0b, 0x813f658590753593, 0x2c18bef893f0f015, 0x553b2e1454362987,
            0x3df5a513a8c8eda1, 0xea02346ab790a874, 0x1578c85dd7ece527, 0x7a3d65b20caf3618,
            0x5df7ddd230258e93, 0xa698ce46bb561659, 0xce34a0b7bc54490f, 0x5aef1df6ed65fdca,
            0xcabd21bae22093e8, 0x6dd3bc3928c97d9b, 0xb31a0523762c3c92, 0x35e611bae5b75770,
            0x2d1e8b8cc0b70178, 0x05ef2cb649ee60b3, 0x0680e4424afbbdcc, 0xe38efa4cef954418,
            0xb942fa6d91ea56f2, 0x829c27188be7bc2d, 0xbf86b6b57e44ba0b, 0x2cf99989cd245178,
            0x599a80a137d7a395, 0xafd58fefcc107588, 0x1ecd3ca6f6b75cfe, 0x389d8795a38bfc44,
            0xfd333dc7bc3ab757, 0x12a74120dac32a0e, 0x8897e7699295b595, 0xa00446d6d6a59b15,
            0xe91363f9678667f5, 0x48faea400b5e574c, 0xae191aadfbe435b5, 0xdfff004f0e1bbd5b,
            0xea3c3f87c71b0d60, 0xed9b09ba4c363279, 0x4165bf8ddb490d9d, 0xc2d11b8f3a3e135c,
            0x9f65d22891dc4c48, 0xde9c8d1611ecfcec, 0xa894bec46e3a6e11, 0x5781db7cede4a4c4,
            0x754987f9da4d6bda, 0xc3329826f3a694b9, 0xcfec8a3ba3133570, 0xb6b831eeb60dcbc5,
            0xc34125144576d66c, 0x8eabfe787932383e, 0xed148211bdc89ef8, 0x44860d8d37fb9072,
            0x6c98dfdbe520d268, 0xae5cb4db0f075d36, 0x997eabc132c54c72, 0xbc49827b93d4593d,
            0x28908e098d828400, 0xed1f578ce5a31dd0, 0x035a9fd5b9f8cb33, 0xdfeea0d4a5e37605,
            0xfbf2788eafa782c6, 0x3e99769551b5054d, 0x10f2f88ad5295e79, 0x2ad7d9c88a95e8af,
            0x72247aecc453bec1, 0x7b68b29cf06a6c1f, 0xc978935aaec7b863, 0xb3b59efb9976fd7f,
            0x666602be27ceb467, 0xbf44a5fc81e38fd7, 0x43839f568ade2ef4, 0x448dfdc22f65e636,
            0x3a8a75d257b37a62, 0x7d0366f04d5a8f0c, 0x809961dfa736c942, 0xfdfc7b36fee2a689,
            0x9f63d8e198982cf9, 0xd7cb0aa8c90aba65, 0x4941f3a69f9b4bb6, 0xf2557bfd0759e1c3,
            0xba5f6897a5e60c7a, 0x6c1b76092228ffba, 0xb81863f6e13a4937, 0x8ae2886373e9dfe4,
            0x98bef8c983b31dd3, 0x80cc7f0bede492f3, 0x80b30054ce9b32dd, 0x73859bca736b75ef,
            0x818677dc6cf49eec, 0x705b6b56f6410e83, 0x27e8df29c5885185, 0x771bb1b5fbab06ca,
            0x296c3f8edaa4081f, 0xe1359431d3773a6a, 0xc2f5f148826e67fd, 0xcaa9328c1665b3c0,
            0xc0045b808cbe3293, 0x013d84b36c8b4d88, 0x19363023b53d8182, 0xdef5b883f05a3dcd,
            0x445369a5d290b073, 0x3f09a4da7e10fcfb, 0x26e37c3942dcc5e7, 0xa5020895816af0fc,
            0xb9f5bd1bac98b491, 0x8f89fdb53e94507a, 0x07221624b505559d, 0x59b7c4b7e49b4ec3,
            0x6a674ee69aa6953e, 0x87725322eff18aa1, 0x11c351da24de3b15, 0x8adb237401025d86,
            0xc21067a3625ece65, 0xa6802e0ab2453646, 0xaf466176aea636f6, 0x520035461c979d10,
            0xb9d2e5259d8661f6, 0x601d95d542ab8cfd, 0xb05438bd84927a43, 0x6ad53154d415401f,
            0xaad6599d3bea97cf, 0x448244e526db878e, 0xe5156887630d0470, 0xb00ee9eee213de2d,
            0x75680cca57f5b2cc, 0x025bf2dad8192adc, 0xccdd10d51361cb11, 0x00517a5d37fe6002,
            0x63d35254dcddf84e, 0x565637c06096aea5, 0xcea80da8e5a94415, 0x054ede7a716fe90e,
            0x46c1e28176529f0f, 0x31f827e3812dce99, 0xb8b50c51b5c77dfd, 0xe546b562c48131c6,
            0x52ea4ea5853fa886, 0xb98e62b82a6e7586, 0xa95e53382bcfa1e8, 0x27c2420f0d65b965,
            0x42eaf900bc85dba1, 0x398db6737addaddd, 0x9ec13ff26aab4e3b, 0x3b8a54b00331177d,
            0xd99602627724a344, 0xf533e27cfd8e2e28, 0x93e68e89b5421fb6, 0x5818073294579d9a,
            0xdcc05f2376656c86, 0xd62e6bf51390943a, 0xaab369c5f8a4eca6, 0x3d0805ab2e8bd8fa,
            0x1a5a08ebb6ed37c2, 0xc9ddb51407c04a61, 0xb1a2042444c5ac26, 0x5709c506f91c673f,
            0x82eca31c8d613177, 0x69315087af9e5270, 0x36f7822ebec54d7b, 0xd30907eef030f13a,
            0x3a67f5d763130110, 0xf488dd1ce0dc273d, 0xcb903fa03550ac33, 0x8105bc22417c4cc7,
            0x968f609e05a482dc, 0x6790d78f7e975130, 0x4a5c64f316fa7907, 0x361278ecbef1f0df,
            0xd877bf67b012041a, 0x0933fb66094cddb6, 0xd63bd4009b495e04, 0x299462e3b23a77b2,
            0xa6241b7e4e754c93, 0xf95eb0f7ef099913, 0x364608828d172e62, 0x8f27ffa446a4f7a3,
            0x846b0d49429d9f2c, 0x2c95cad5569b815b, 0xae911ab3e57dc699, 0x4010c5d315d0ae65,
            0x28ebfb4b54b5a27c, 0x0c6a52dcdf170d31, 0x1b970177c078a6b6, 0x682a85562753f766,
            0xd79ab1242fa3a259, 0x23331569b8d0ffda, 0x03873e3ddd08471b, 0xac14a8ebc8aea5ec,
            0x43d2b97d1851f79d, 0xa16566d52057c8a9, 0xbcb1421f1383d793, 0xee765c89364bd158,
            0x3067a93ef08f98f7, 0x867a832ea53a8295, 0xcdd1e04c068e5c8f, 0x6ce1e47c9b756af5,
            0x7095b58b0fbbe510, 0xa3afb43e5c406096, 0xaa4aff0fc49270d6, 0x0eed9679754167aa,
            0xf8078b6cdeb94481, 0xb1bb6fbe1b5c4c1e, 0x6474a42c57fddcde, 0x134b900c6910c047,
            0xcfe86deeba978907, 0x68086fd7da495907, 0x68eb2d9f72aa064d, 0x4a5d211fb3ac4f38,
            0x401f5fff38f45140, 0xc9b4cda70965c1f6, 0xae21df74ed45f4b1, 0x0aab5d351e87ef49,
            0x664f32472a8d523b, 0x890fba9b198acb92, 0xc2459a83eb7f0cf3, 0xa9f10135ef37ff5a,
        };

        coeff_t _n[sizeof(n) / sizeof(coeff_t)];

        math_uintx_mul_to_Karatsuba(p, q, sizeof(p) / sizeof(coeff_t), _n);
        return memcmp(n, _n, sizeof(n)) == 0;
    }
    


}
