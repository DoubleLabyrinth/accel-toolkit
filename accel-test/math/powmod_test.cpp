#include "mathlib/powmod.h"
#include <memory.h>

namespace accel::test {

    bool powmod_Test() {
        static const coeff_t a[] = {
            0xdf43a8758d70c02a, 0x8cb71a476a0e4e31, 0x25ecd50e9ba9224a, 0x9014e339a471ad7d,
            0x48cef792475f6f9d, 0x7753a2783d764723, 0xeb157ac3daed8744, 0x086e5681942d2f39,
            0x4cc1b282ad1465dd, 0x2c97e174d070f37e, 0xbcebd21142eb3a92, 0x7394c64befedd7bb,
            0x6ea63af307913488, 0x40be532390f401db, 0xbf8ad5b63a6fd31a, 0x6592f3c50a70a26f,
            0xc9f9409c75fc6d30, 0xe6b9f277e5f90370, 0xfa99110bf8ea063d, 0x5a8d185dd7859154,
            0x6cda2530ac109d4b, 0x4ed1664f4dae43bc, 0x6beb4d5871b03e5b, 0x33592e2a72d3da60,
            0xb4da22a84c5d9d1d, 0xe5fc77d5530bfa07, 0x72cc15e47f5e451e, 0x0a199e203b4cb0a5,
            0xb816b19e89fa50a2, 0xca331960ccf4d8ac, 0x350c04f826bc3026, 0x4a4b4f5eca5707b1,
            0x351266662a549f50, 0x1ab78a5eb24d6282, 0x581e85aa2d125faa, 0x9aeb5749158a19bf,
            0xc28b24ff5e0d1af8, 0xac4781ceee5949de, 0xcf5f3a9c37db2e4f, 0x9cbae89f95b67776,
            0xa299d6adc10e5f37, 0x9e7713fa6608120c, 0xc75a175158af3702, 0x301ab6ea9d07a3ee,
            0x8da13a9acbcf09bc, 0xa9868ee3c6d0143a, 0x681d59ffafd1e31e, 0x6cbe664dd4593376,
            0x853c3f67aaf7f056, 0xcf9c6c3d0bd38ab9, 0x8092755daf509d8b, 0x2d3b96e21b9b7465,
            0xa5c0d9f2bf75c1a0, 0x321a942ed0349cb9, 0xb8bc44841c14b471, 0x47feab8cbc3b2872,
            0xdff0866c2341be9a, 0xf54dacbadd0d601a, 0x9927556a233346c8, 0xe09bc1058e043546,
            0x3ed81a5e1419a22e, 0x2362e8f251e4d060, 0xc697625f75a890e0, 0xb24a63fc5f22095f,
            0xa67e679c4d468bea, 0x3e594c9dea7a906d, 0xdb65b8e5e7cd0dd4, 0xbe6164e1fd62c25f,
            0xbda15867c5ffb5e2, 0x007d330677cced39, 0x711e13a71b7c7a0f, 0x39d1950c071f9de5,
            0x5886b5cc4583f319, 0xc5acf24a45b20450, 0x5f143555a286ce6d, 0x7f7ff37f6da460fe,
            0x1f07a337a3a6f6ab, 0xe54e94ba292a84cf, 0xfde66fb8f7f5bfd5, 0xcdb75960c7459a64,
            0x60f416255e33caa2, 0x74114b87429ba8fe, 0x0c9d2830a0999eb0, 0x29b6c499f1e58fba,
            0xd6489f58eac424de, 0xf03f222e902e5c46, 0x2ff312ebbde18a82, 0xb6646e6ad1a136fd,
            0x0011341c4f6258cd, 0xde773afa3366057b, 0x5b8ae9b31e32e59d, 0x64bf52ed297c7c44,
            0x2dfdef85a92531e4, 0xaa1aefd07e714333, 0x1da2402022acd8d1, 0x528ad45f8e8fb174,
            0xb48f2db1e0a6b1ae, 0x20f185f7d30b630c, 0x5a781f77381a677e, 0x4dd07182cdc75191,
            0x281e1bf9c707b899, 0xab3b5395399eefad, 0x9eba8af9ca96abe4, 0xa1c00f99e8d4d2af,
            0x7d6a76fc60e59ad2, 0x95baef78cd9e0e6f, 0x39db58c8384e03a5, 0x4cbe9b8a095a5a8a,
            0xa7df7a0d0b112e08, 0xf6e69a4df1237d22, 0x8e4c9e8268c790aa, 0xca8fe33a6137d004,
            0x4cefb6c04ed9a6e3, 0xabeddf0a479031c5, 0x7a7e0b67e2f4de8f, 0x5bef9cf744172840,
            0x77a5853d98f7a95d, 0x8bf9f5b4bfed6961, 0xfdba2a699be30f38, 0x485e6857d4f84ce4,
            0x23b0f736a6d87913, 0x5ef5b0fd6d1e09ee, 0x72bb30efc50f3bd5, 0xbb3cd3169c66991b,
            0x13db09ab84d5d116, 0xc0574cff04b9dfcc, 0xc14bdefec373aa3b, 0x9b5650524b6c9b66
        };

        static const coeff_t b[]{
            0x6a3306b6379115bc, 0xbc2242e584b93ed2, 0xcde93f4fc5e9369a, 0x57217a7409e52bea,
            0xdd0e53955bd63320, 0x1880c984d5fe098c, 0xc7819320cd4bd86f, 0x2061066c4a38e62e,
            0x87cc3e300001d188, 0xfd7159d283195f3b, 0xbae887dffb4d82d0, 0xbdf24aec5cb747ce, 
            0x276b6a610d5a87b9, 0x11e8921d449d4962, 0x8b38010f672d209a, 0x1786f968eca1eaaa, 
            0x621826c4e26779cc, 0x9e2c54f9f5e935ed, 0xbf8fd3e50ef2d7b2, 0x99dfe01293d0b7fc,
            0xc5951d441e84611c, 0x83ccf8abb7b2c5e9, 0xfd894ba248e54e60, 0x2b23376a853fcd98, 
            0xfeb9322dfff32959, 0x395e4632c1255b41, 0x46d97d4d96b2288e, 0xa80a691e9e593979, 
            0x45aaa02ebe447c44, 0x70c30c41eb97ee8c, 0xd14198bae201f074, 0x40842f1789d27a95, 
            0xad34de9a52fa7f5c, 0xb7978749e392fea9, 0x54cf3b912a9ed1c5, 0x879846f8ad7375f2, 
            0x3dc823941612a600, 0x5ab4b6fe12cbf948, 0x50897d678d868944, 0x3113337a549328bb, 
            0xa2a708dd1c1f9e86, 0x5f366ad9a4904afa, 0xa7ad6c116589da4e, 0xdc8f543a2dfe2c2f, 
            0x99ce9a582570f156, 0xd5249f04fdeb85bc, 0x91f739845a7da1de, 0x2023cca94be2b90b,
            0x0f034126f382fd29, 0xfffaa6af9d259477, 0x9a8dd9242e3d1ff4, 0x2e4d77ff7aa2a56d, 
            0x522df1a41a57c898, 0x089dd3cf5f2d21ec, 0x431e8c15647265c8, 0xbb6123823c7fc67f, 
            0x4d414109391a0fe1, 0x1cf1351fdb94f304, 0xbf52f77ce2c27392, 0x8eca3e8f5edb1b99, 
            0xf026773f53cca378, 0x58ad3627d43f9726, 0xe3f4728a93834b43, 0x05012d2ff5c6fec4, 
            0x372ca40219450f89, 0x3dbb24021c2f0110, 0x266921595a069d15, 0x0035098b84f9be95, 
            0x39e83b5022931b1b, 0x9fd30aaf679f097d, 0xbd15453a942dfbd8, 0xa5f7c3a1f35d3ef2, 
            0xb76705cac0c246c4, 0x496ab16f89b6e63f, 0xe30eb796404adb43, 0x931b5c237446f438, 
            0xb62844503ec2d7c6, 0x25d2dd6492b34331, 0x1e8b9afea052a8c9, 0x16e798baecae8c13, 
            0x518889e008c44fa1, 0x415f922a03a1f470, 0xf02fca4f0a341448, 0xf6a54b25a4c6b190,
            0x9bca65c5e4df5c56, 0x6a10c0d9e880f9c3, 0x0e5a8605c1924885, 0x80cfb0d97f0d82e3, 
            0xc8c576d59379d634, 0xa5fabe58dec4d78a, 0x56dca5a64dc871c8, 0x24a8b3d5a1d38c4c, 
            0x03208ca12538da61, 0xc98513d5e80b8372, 0x88562604e6ad7369, 0x5b636996e4f60f71, 
            0x4464b4cfb3106253, 0xa641895197e893f9, 0x04de28b654519760, 0xf3d6c1977e1afa1e, 
            0x1712afe55a5b1852, 0xfff3c47fa4489dc4, 0xd9daaee10721be91, 0xff4a23da53f0c879,
            0x4fb1df5f442bc1e9, 0x3e58dd17c3b35784, 0xecac7417be47b2b9, 0x3ee214a24871ffcb, 
            0x5185cad92e9c4d31, 0xc5461fded239e404, 0x584a871cdd9c8917, 0xe6f18f154e7bc1a8, 
            0xa6e7ff05366b76bd, 0x5b330152f24e4eba, 0x97d9769d1acdd6ae, 0xfe3546387e2fda09, 
            0x718141caeeff0592, 0xed4270e8d639ef08, 0x74fe727fb1ac5da8, 0xfd5f1f8d63aafd41,
            0x20755073119c41e6, 0x08a9af563d2d513e, 0x14e34915df39ab6c, 0xb17cd635329e6a5a,
            0x3b1030ee9fbaaea6, 0x99496b4f10a50eec, 0x436985d43aecbd59, 0xf1349dfba317f5e4
        };

        static const coeff_t c[] = {
            0xe7d9cb996254a46f, 0x321818b1ed5144d4, 0x062ea191df107dfb, 0xc65fb0b06c15592f, 
            0x48658549585c58cb, 0x2022efc8e330ae2e, 0x9e74581b29f7107d, 0xb693dda493ed1c40, 
            0xd8d347d0001fe425, 0x81b7957a36e7b015, 0xd97f76b6f583c038, 0x1de0c286f2a4f6a7, 
            0xaba83245abd31510, 0x9540a26dc53fd22c, 0x393fad5b31e95950, 0x2c44a03a6df17abc, 
            0x440ff7a026d73b40, 0x6ecbe200511245e8, 0x1a8858cdaf01e55b, 0x9567979badc1f294,
            0x6c34863ac5f1fa32, 0xe8c47f0230bab8e8, 0x92ac1ac55822b06a, 0x3019f337360a4ff6, 
            0xb7dd63465c53200c, 0xdb8230f22a291fcf, 0x49e01ce183bfd0c0, 0x280a8937866190de, 
            0x5ffd5155bf2bb6e3, 0x4fca17d8abac8266, 0x991e3b8500648438, 0x55bc853db0bcfda8, 
            0x07662d81d3c38a1f, 0xce808a42c7b2cefd, 0xb566c57ce704ea11, 0x3f5190a6a3f7280e, 
            0x1774aeafd9f87ebc, 0xc889a9fa5c756b8c, 0xd7330136cdd89ca4, 0x1ac33a8a058179aa, 
            0xc4783ba859647b38, 0xc2193c3d6e09f1b6, 0x5148d471a21f6644, 0x95d8581bbfdaeb6b, 
            0x507ec1ae1295f4bd, 0xbbcc0fd527b11ea6, 0x79183931ffc2fde2, 0xcf74e05354115bb3, 
            0xc96e4c163f007f46, 0xefd760ce2a6fce3e, 0x7a5db718c2a35778, 0xf3af8f037c147dbd, 
            0x5b0eeffdfebce175, 0xc5d168862f31b1a4, 0xccba1b30507b8e23, 0x8c7704bc9189ab9a, 
            0xb921fffdf737d120, 0x27b10001f8f1c59c, 0x45be2f4d1329aaea, 0xe6375d79715d91fc, 
            0x272ad95c006e6097, 0xc96eba5b7abe05d5, 0x247c325296fbede7, 0x75fe9eee7301c61d, 
            0xd0796d5e14b72428, 0x353bddcad60a69e9, 0x366d1f239f80f97e, 0xacf5fe4e3dd6c9df, 
            0xcfcdc021a5b09b05, 0x4d72d8bde0632e12, 0xd36b6ec9ed2fc51f, 0x3f2d7ecd2ddc7973, 
            0x91b225cb7cce1b51, 0x08401870e512cd4b, 0x280b3523b33d63f4, 0xe62ee49f53c33929, 
            0xccf1aaafb97a80cc, 0x2f2a3177ca2bbb01, 0x8be74de3843d6e37, 0x13e189bf9714a80f, 
            0x7477183acc5b8001, 0xd50d46f04268b548, 0x5e21e330fbc23f04, 0x47099fd830164b17, 
            0x2676dd8d9784d224, 0x4ab095a5247c188b, 0x4675a390c06d076e, 0x079d705558eae716, 
            0xb447a795c21e0048, 0x25dc1f2a944836ea, 0xed46925e153fc96a, 0xbe1748d0f946dda0, 
            0x44da808c3ce32a23, 0xe04276532b0ed176, 0xb6b125a2f36fc34f, 0xf5133cc71612d5da, 
            0x0b04b4b0516c5a90, 0x083354b6bc133a5e, 0x6a0ca33d753c0c39, 0x746ef42815a57681, 
            0xb0369ac8ea77998f, 0x99c211e109b1dc51, 0xda8aa25d91347152, 0xbd0dab355350ec14, 
            0x046fc49f0bfdbfe2, 0xd3411fbef5ff46c8, 0x7818f9f2e12fe390, 0xff33bc59e8a73083, 
            0x869b3e01584302fc, 0x72959157baebb084, 0xe535ed36d4a3e3de, 0xc6b39ca210dffd9a, 
            0x8902f5c4808589e7, 0x9cc9e883df0df388, 0x3132696fa815dc72, 0x7c3ccea4bdbfaf09, 
            0xc2cb34d43672df72, 0xd4d25dad62893459, 0x23d141d4bf55b8b1, 0x889278b915d49c82, 
            0xe11e4945f516904b, 0xeca06cd90ef732f8, 0x192271ee244eb2e9, 0xa96ec544881e9ba5, 
            0x190a84a902714f7b, 0x4edcf37223ca30c0, 0xbec5df0aef955cba, 0xfc1b5219b78e3b62
        };

        static const coeff_t n[] = {
            0xff90e98bf760c9d0, 0xf8132f97a1f2f071, 0x6d16e46854a1b9f9, 0x34cb342726cfd376, 
            0xa2d75a01ca63a0b6, 0x648645cf8bfb28c6, 0x515b24e0a6182589, 0xe8b0f298769fa8de, 
            0x0ad2201c1b8dd465, 0x45720295b976bfce, 0x7e79f1cf9aa5b42c, 0xf6b96bdc8c368ccf, 
            0x8ef78281af2bc176, 0x825c06bb011587c3, 0xbac922fe545c0bb0, 0x962ab750cfbe3f38, 
            0xad525149751c4435, 0xa35069ef76dd9bcd, 0xf5be901248494994, 0xe5e83429340b26a8, 
            0x1a38ce29c1939b3d, 0x5f9e4a271362c7bc, 0xd53ec07d228da8e8, 0x8000e510c68ef3b6, 
            0xc235ed55a593ebb6, 0xbe227af003a1b071, 0x81efebc374f00745, 0x212136bbca7cb537, 
            0x69c38da9fd7437b0, 0xc080c3beda1202ab, 0xc1be983fb8ac0415, 0xb063c0571afd70c9, 
            0x761c6b363c43baa1, 0xd19827ffca244891, 0x889a6b736aefab00, 0x7f368231e9781ee9,
            0x9eef23b94b90cb5b, 0x36442fa8eeec8711, 0xf43a0ac32bbacf45, 0x7482fbecd18415a7, 
            0xcebf010cdc5dba4d, 0x7ca8aeef62a034d6, 0xcc73e5aeab19c466, 0xcb3149b2a7b55bfc, 
            0x39cbe27abce5aaf0, 0xe05399886d7ec639, 0xd55a6ccdd7947ebc, 0x0056054990ba0803, 
            0x0b635e47557d9702, 0x881ebccd3028a80b, 0x5dc3004b7e8df27e, 0x2d1d477feadae83b, 
            0xa30c554e7366982b, 0x897471034e02c624, 0xcd3879ad9fb7f97d, 0xec4ebeb8771f7fa8, 
            0xdf32245d02a8a7dc, 0x3e05ed7cf24fc5b0, 0xcfba36e6d67c4189, 0x77de02531d364626, 
            0xb1020a52db82515f, 0xc9feaf2ca7d93be0, 0x3d821c9935806fdd, 0xd4b51fdc9b21587c, 
            0xe48abfc5b0f188af, 0x2d53c903683e211a, 0x8fa328cdc9ceb278, 0x3a637cff54c74adf, 
            0x4f30835f4e49fd8b, 0x4b9c1a7fdb98e45d, 0x06a640cf5819bea1, 0x104a61d18c13fcb0, 
            0x2c79d9ca682ec03a, 0x7290e26b900bd258, 0x271fdee72fb69fc0, 0x9a45e994d234fc36, 
            0x730684008a0e468d, 0xa4f6b1ecf11a35bb, 0xe438a83f6742bf6a, 0x23d61699fdc3ae80, 
            0x16e91d89e0ff3d5d, 0x5ce59c491bcc20d0, 0x25b32608d40191c2, 0xd766441caa74d0f6, 
            0x8098b3c83a0127de, 0x41324e3d73fff3dc, 0x774169bcfaa4430d, 0xea3c4908cbe68b40,
            0x9406a6b5c7f8c01c, 0xa0a2f97da4c296e7, 0x5c2be9aec8c03d7e, 0x4a1fe8645017f12e,
            0x67273eb7f329626b, 0xc7147feac06a5baf, 0xdfab759e4a6e67ca, 0xbb7e6a07ed581c83,
            0x96e497c22bf9802f, 0x3976d03328c18d89, 0xb9359ca7d65b3920, 0x15ac5ee5bfee143f,
            0xe08cffac5dfba60f, 0x7643790d0dcb5f6a, 0x1e037c4d7a43e84b, 0xdbe0cd9e3d983a14, 
            0xe808ffca4c3e9a16, 0xb597eb33b0ee998f, 0xea3845131c425d3a, 0x6d7bc8eff2a62ea4, 
            0xbe684a23c052c341, 0x448c20cd40b27c76, 0xf453e2c5209e4ebf, 0x0b9b1796b5f9b502, 
            0x00d7a0ad9e9b27a6, 0xa784f9092d9bdb4c, 0x696f07aa27baf811, 0x772534bacf6a1dae, 
            0x8b376ff9ec753540, 0x8603fb1d9022cd65, 0xe79c58b1b3078ae7, 0x76b92808adb8a654, 
            0x96b8941672a8583e, 0x28d93412010e8055, 0xad7300d5117a5b08, 0xec96d78f7de2fcf1, 
            0x1484b3fd5aa8aac3, 0xc02b017c520710c1, 0xc0505873a37d7c37, 0x8e5af4994a928838
        };

        coeff_t _n[sizeof(n) / sizeof(coeff_t)];
        memcpy(_n, a, sizeof(a));
        math_uintx_powmod(_n, sizeof(_n) / sizeof(coeff_t), 
                          b, sizeof(b) / sizeof(coeff_t), 
                          c);
        return memcmp(_n, n, sizeof(n)) == 0;
    }

}